<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üçΩ –û—Ü–µ–Ω–∏ –±–ª—é–¥–∞ –í–∞–ª–µ–Ω—Ç–∏–Ω—ã</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:#1a1a2e;color:#e0e0e0;min-height:100vh;padding:16px}
.container{max-width:600px;margin:0 auto}
h1{color:#d4a843;font-size:1.4em;margin-bottom:4px}
.sub{color:#888;font-size:0.85em;margin-bottom:16px}
.who{display:flex;gap:8px;margin-bottom:16px}
.who button{flex:1;padding:12px;border-radius:10px;border:2px solid #2a2a4a;background:#16213e;color:#ccc;font-size:1em;cursor:pointer;transition:all .2s}
.who button.active{border-color:#d4a843;color:#d4a843;background:#1a2744}
.cats{display:flex;gap:6px;margin-bottom:12px;flex-wrap:wrap}
.cats button{background:#16213e;border:1px solid #2a2a4a;color:#aaa;padding:4px 12px;border-radius:16px;font-size:0.8em;cursor:pointer}
.cats button.active{background:#d4a843;color:#1a1a2e;border-color:#d4a843}
.dish{background:#16213e;border-radius:10px;padding:12px;margin-bottom:8px;display:flex;align-items:center;justify-content:space-between}
.dish-left{flex:1}
.dish-name{font-weight:600;font-size:0.95em}
.dish-info{color:#888;font-size:0.75em;margin-top:2px}
.stars{display:flex;gap:4px}
.star{font-size:1.6em;cursor:pointer;color:#333;user-select:none;-webkit-tap-highlight-color:transparent;transition:color .15s}
.star.filled{color:#d4a843}
.progress{background:#16213e;border-radius:10px;padding:14px;margin-bottom:16px;text-align:center}
.progress .num{font-size:2em;color:#d4a843;font-weight:700}
.progress .lbl{color:#888;font-size:0.85em}
.bar{height:6px;background:#2a2a4a;border-radius:3px;margin-top:8px;overflow:hidden}
.bar-fill{height:100%;background:#d4a843;border-radius:3px;transition:width .3s}
.send-btn{width:100%;padding:14px;background:#d4a843;color:#1a1a2e;border:none;border-radius:10px;font-size:1.1em;font-weight:700;cursor:pointer;margin-top:12px;margin-bottom:40px}
.send-btn:hover{background:#e0b850}
.send-btn:disabled{background:#333;color:#666;cursor:default}
.toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#0f3460;color:#d4a843;padding:10px 24px;border-radius:8px;font-size:0.9em;display:none;z-index:100;border:1px solid #d4a843}
.toast.show{display:block}
</style>
</head>
<body>
<div class="container">
  <h1>üçΩ –û—Ü–µ–Ω–∏ –±–ª—é–¥–∞ –í–∞–ª–µ–Ω—Ç–∏–Ω—ã</h1>
  <p class="sub">–ù–∞–∂–º–∏ –Ω–∞ –∑–≤—ë–∑–¥—ã: 1‚òÖ –Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è ‚Äî 5‚òÖ –æ–±–æ–∂–∞—é. –ü—Ä–æ–ø—É—Å–∫–∞–π —á—Ç–æ –Ω–µ –ø—Ä–æ–±–æ–≤–∞–ª–∏.</p>

  <p class="sub" style="margin-bottom:8px">–ö—Ç–æ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç?</p>
  <div class="who" id="who"></div>

  <div class="progress" id="progress"></div>

  <div class="cats" id="cats"></div>
  <div id="dishes"></div>

  <button class="send-btn" id="sendBtn" onclick="sendResults()">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫–∏ –ú–∞–∫—Å—É</button>
</div>
<div class="toast" id="toast"></div>

<script>
const DISHES = [
  {id:1,name:"–ë–µ—Ñ—Å—Ç—Ä–æ–≥–∞–Ω–æ–≤",g:"–ø—é—Ä–µ/–≥—Ä–µ—á–∫–∞/–±—É–ª–≥—É—Ä",cat:"–º—è—Å–æ",n:14},
  {id:2,name:"–†–æ–ª–ª—ã",g:"",cat:"–¥–µ—Ç—Å–∫–æ–µ",n:12},
  {id:3,name:"–ù–∞–≥–≥–µ—Ç—Å—ã –∫—É—Ä–∏–Ω—ã–µ",g:"",cat:"–¥–µ—Ç—Å–∫–æ–µ",n:12},
  {id:4,name:"–ì—Ä–∏–±–æ—á–∫–∏ —Å —Å—ã—Ä–æ–º",g:"",cat:"–∑–∞–∫—É—Å–∫–∞",n:11},
  {id:5,name:"–ö—Ä–∞–±–æ–≤—ã–π —Å–∞–ª–∞—Ç",g:"",cat:"—Å–∞–ª–∞—Ç",n:9},
  {id:6,name:"–ö—É—Ä–∏—Ü–∞ –≤ —Å–ª–∏–≤–æ—á–Ω–æ–º —Å–æ—É—Å–µ",g:"–±—É–ª–≥—É—Ä/–≥—Ä–µ—á–∫–∞",cat:"–ø—Ç–∏—Ü–∞",n:8},
  {id:7,name:"–ê–¥–∂–∞–ø—Å–∞–Ω–¥–∞–ª–∏",g:"",cat:"–æ–≤–æ—â–∏",n:8},
  {id:8,name:"–ö–ª–µ—Ñ—Ç–∏–∫–æ",g:"–∫–∞—Ä—Ç–æ—à–∫–∞",cat:"–º—è—Å–æ",n:7},
  {id:9,name:"–ì–æ–ª—É–±—Ü—ã",g:"",cat:"–º—è—Å–æ",n:7},
  {id:10,name:"–•–∞—Ä—á–æ",g:"",cat:"—Å—É–ø",n:6},
  {id:11,name:"–í–∏–Ω–µ–≥—Ä–µ—Ç",g:"",cat:"—Å–∞–ª–∞—Ç",n:6},
  {id:12,name:"–¢–≤–æ—Ä–æ–∂–Ω–∞—è –∑–∞–ø–µ–∫–∞–Ω–∫–∞",g:"–±–∞–Ω–∞–Ω/—è–±–ª–æ–∫–æ",cat:"–≤—ã–ø–µ—á–∫–∞",n:5},
  {id:13,name:"–ü–ª–æ–≤",g:"",cat:"–º—è—Å–æ",n:4},
  {id:14,name:"–ü–µ—Ä–µ—Ü —Ñ–∞—Ä—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π",g:"",cat:"–º—è—Å–æ",n:4},
  {id:15,name:"–¢–≤–æ—Ä–æ–∂–Ω—ã–µ —Å—ã—Ä–Ω–∏–∫–∏",g:"",cat:"–≤—ã–ø–µ—á–∫–∞",n:4},
  {id:16,name:"–¢–µ—Ñ—Ç–µ–ª–∏/—Ñ—Ä–∏–∫–∞–¥–µ–ª—å–∫–∏",g:"–ø—é—Ä–µ/—Å–æ—É—Å",cat:"–º—è—Å–æ",n:4},
  {id:17,name:"–ö–æ—Ç–ª–µ—Ç—ã –ø–æ-–∫–∏–µ–≤—Å–∫–∏",g:"–≥—Ä–µ—á–∫–∞",cat:"–ø—Ç–∏—Ü–∞",n:3},
  {id:18,name:"–õ–∞–∑–∞–Ω—å—è",g:"",cat:"–º—è—Å–æ",n:3},
  {id:19,name:"–®–Ω–∏—Ü–µ–ª—å –∫—É—Ä–∏–Ω—ã–π",g:"–≥—Ä–∏–±–Ω–æ–π —Å–æ—É—Å",cat:"–ø—Ç–∏—Ü–∞",n:3},
  {id:20,name:"–ú—É—Å–∞–∫–∞",g:"",cat:"–º—è—Å–æ",n:3},
  {id:21,name:"–ö—É—Ä–∏—Ü–∞ —Å —Ä–∏—Å–æ–º –∏ –ø–µ—á–µ–Ω—å—é",g:"",cat:"–ø—Ç–∏—Ü–∞",n:3},
  {id:22,name:"–°–≤–∏–Ω—ã–µ —Å—Ç–µ–π–∫–∏ –≤ —Ä—É–∫–∞–≤–µ",g:"–æ–≤–æ—â–∏",cat:"–º—è—Å–æ",n:3},
  {id:23,name:"–û–≤—Å—è–Ω—ã–µ –ø–µ—á–µ–Ω—å—è",g:"",cat:"–≤—ã–ø–µ—á–∫–∞",n:3},
  {id:24,name:"–ú–∞–∫–∞—Ä–æ–Ω—ã —Å –∫—Ä–µ–≤–µ—Ç–∫–∞–º–∏",g:"",cat:"—Ä—ã–±–∞",n:3},
  {id:25,name:"–ö–æ—Ç–ª–µ—Ç—ã –º—è—Å–Ω—ã–µ",g:"–∫–∞—Ä—Ç–æ—à–∫–∞/–≥—Ä–µ—á–∫–∞",cat:"–º—è—Å–æ",n:3},
  {id:26,name:"–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å–Ω–∞—è –∑–∞–ø–µ–∫–∞–Ω–∫–∞ —Å –º—è—Å–æ–º",g:"",cat:"–º—è—Å–æ",n:3},
  {id:27,name:"–ö—É—Ä–∏—Ü–∞ –≤ –∫—Ä–∞—Å–Ω–æ–º —Å–æ—É—Å–µ",g:"—Ä–∏—Å/–≥—Ä–µ—á–∫–∞",cat:"–ø—Ç–∏—Ü–∞",n:2},
  {id:28,name:"–ì—É–ª—è—à –º—è—Å–Ω–æ–π",g:"–≥—Ä–µ—á–∫–∞",cat:"–º—è—Å–æ",n:2},
  {id:29,name:"–ü–∏—Ä–æ–∂–∫–∏/—Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏",g:"–º—è—Å–æ/—è–±–ª–æ–∫–æ/–∫–∞–ø—É—Å—Ç–∞",cat:"–≤—ã–ø–µ—á–∫–∞",n:2},
  {id:30,name:"–û—Å—å–º–∏–Ω–æ–≥",g:"",cat:"—Ä—ã–±–∞",n:2},
  {id:31,name:"–ú—è—Å–Ω–æ–π —Ä—É–ª–µ—Ç",g:"–æ–≤–æ—â–∏/—è–π—Ü–æ",cat:"–º—è—Å–æ",n:2},
  {id:32,name:"–ü–∞—Å—Ç–∏—Ü–∏–æ",g:"",cat:"–º—è—Å–æ",n:2},
  {id:33,name:"–°—É–ø —Å —Ñ—Ä–∏–∫–∞–¥–µ–ª—å–∫–∞–º–∏",g:"",cat:"—Å—É–ø",n:2},
  {id:34,name:"–ì–æ—Ä–æ—Ö–æ–≤—ã–π —Å—É–ø",g:"",cat:"—Å—É–ø",n:2},
  {id:35,name:"–°–æ–ª—è–Ω–∫–∞ –∏–∑ –∫–∞–ø—É—Å—Ç—ã",g:"",cat:"–æ–≤–æ—â–∏",n:2},
  {id:36,name:"–ì–Ω—ë–∑–¥–∞ —Å –º—è—Å–æ–º",g:"",cat:"–º—è—Å–æ",n:2},
  {id:37,name:"–ë–∞–∫–ª–∞–∂–∞–Ω—ã —Å —Ñ—Ä–∏–∫–∞–¥–µ–ª—å–∫–∞–º–∏",g:"",cat:"–º—è—Å–æ",n:2},
  {id:38,name:"–ú–∞–ª–µ–Ω—å–∫–∏–µ –∫–∞–ø—É—Å—Ç–∫–∏",g:"–±—Ä—é—Å—Å–µ–ª—å—Å–∫–∞—è",cat:"–æ–≤–æ—â–∏",n:2},
  {id:39,name:"–ë–ª–∏–Ω—á–∏–∫–∏ —Å –º—è—Å–æ–º",g:"",cat:"–≤—ã–ø–µ—á–∫–∞",n:1},
  {id:40,name:"–û–ª–∏–≤—å–µ",g:"",cat:"—Å–∞–ª–∞—Ç",n:1},
  {id:41,name:"–ß–∞—à—É—à—É–ª–∏",g:"",cat:"–º—è—Å–æ",n:1},
  {id:42,name:"–Ø–±–ª–æ—á–Ω—ã–π –ø–∏—Ä–æ–≥",g:"",cat:"–≤—ã–ø–µ—á–∫–∞",n:1},
  {id:43,name:"–ú—è—Å–Ω–æ–µ —Ä–∞–≥—É",g:"",cat:"–º—è—Å–æ",n:1},
  {id:44,name:"–ë–ª–∏–Ω—á–∏–∫–∏ –∏–∑ —à–ø–∏–Ω–∞—Ç–∞",g:"",cat:"–æ–≤–æ—â–∏",n:1},
  {id:45,name:"–ò–Ω–¥–µ–π–∫–∞ –∑–∞–ø–µ—á—ë–Ω–Ω–∞—è",g:"",cat:"–ø—Ç–∏—Ü–∞",n:1},
  {id:46,name:"–ò–Ω–¥–µ–π–∫–∞ —Å –∫–∞–ø—É—Å—Ç–æ–π",g:"",cat:"–ø—Ç–∏—Ü–∞",n:1},
  {id:47,name:"–•–∞—á–∞–ø—É—Ä–∏",g:"",cat:"–≤—ã–ø–µ—á–∫–∞",n:1},
  {id:48,name:"–ö—É—Ä–∏–Ω—ã–µ —Ä—É–ª–µ—Ç–∏–∫–∏",g:"",cat:"–ø—Ç–∏—Ü–∞",n:1},
  {id:49,name:"–†—ã–±–∞ —Å –æ–≤–æ—â–∞–º–∏",g:"",cat:"—Ä—ã–±–∞",n:1},
  {id:50,name:"–ö–∞–ª—å–º–∞—Ä—ã —Å —Ä–∏—Å–æ–º",g:"",cat:"—Ä—ã–±–∞",n:1},
  {id:51,name:"–°–∞–ª–∞—Ç —Å –∫–∞–ª—å–º–∞—Ä–∞–º–∏",g:"",cat:"—Å–∞–ª–∞—Ç",n:1},
  {id:52,name:"–ú–∏–º–æ–∑–∞ —Å —Ç—É–Ω—Ü–æ–º",g:"",cat:"—Å–∞–ª–∞—Ç",n:1},
  {id:53,name:"–ì—Ä–∏–±–Ω–æ–π —Å—É–ø —Å –ª–∞–ø—à–æ–π",g:"",cat:"—Å—É–ø",n:1},
  {id:54,name:"–ö–∏—Ç–∞–π—Å–∫–∏–π —Å—É–ø",g:"",cat:"—Å—É–ø",n:1},
  {id:55,name:"–û–ª–∞–¥—å–∏",g:"",cat:"–≤—ã–ø–µ—á–∫–∞",n:1},
  {id:56,name:"–¢–æ—Ä—Ç –ú–æ–Ω–∞—Å—Ç—ã—Ä—Å–∫–∞—è –ò–∑–±–∞",g:"",cat:"–≤—ã–ø–µ—á–∫–∞",n:1},
  {id:57,name:"–ü–∞—à—Ç–µ—Ç",g:"",cat:"–∑–∞–∫—É—Å–∫–∞",n:1},
  {id:58,name:"–•–∞—á–∞–ø—É—Ä–∏",g:"",cat:"–≤—ã–ø–µ—á–∫–∞",n:1}
];

const PEOPLE = ["–ú–∞–∫—Å","–Æ–ª—è","–ú–∏–ª–∞","–í–∞—Å–∏–ª–∏—Å–∞"];
let currentPerson = null;
let ratings = JSON.parse(localStorage.getItem('vr')||'{}');
let activeCat = '–≤—Å–µ';

function init(){
  // Who buttons
  document.getElementById('who').innerHTML = PEOPLE.map(p =>
    `<button onclick="setPerson('${p}')" id="who-${p}">${{–ú–∞–∫—Å:'üë® –ú–∞–∫—Å',–Æ–ª—è:'üë© –Æ–ª—è',–ú–∏–ª–∞:'üëß –ú–∏–ª–∞',–í–∞—Å–∏–ª–∏—Å–∞:'üëß –í–∞—Å–∏–ª–∏—Å–∞'}[p]}</button>`
  ).join('');
  renderCats();
}

function setPerson(p){
  currentPerson = p;
  PEOPLE.forEach(x => document.getElementById('who-'+x).classList.toggle('active', x===p));
  render();
}

function renderCats(){
  const cats = ['–≤—Å–µ', ...new Set(DISHES.map(d=>d.cat))];
  document.getElementById('cats').innerHTML = cats.map(c =>
    `<button class="${c===activeCat?'active':''}" onclick="setCat('${c}')">${c}</button>`
  ).join('');
}

function setCat(c){ activeCat=c; renderCats(); render(); }

function render(){
  if(!currentPerson){ document.getElementById('dishes').innerHTML='<p style="color:#888;text-align:center;padding:20px">üëÜ –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ –∫—Ç–æ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç</p>'; updateProgress(); return; }
  let dishes = activeCat==='–≤—Å–µ' ? DISHES : DISHES.filter(d=>d.cat===activeCat);
  document.getElementById('dishes').innerHTML = dishes.map(d => {
    const r = (ratings[currentPerson]||{})[d.id]||0;
    return `<div class="dish">
      <div class="dish-left">
        <div class="dish-name">${d.name}</div>
        <div class="dish-info">${d.g?d.g+' ¬∑ ':''}${d.cat} ¬∑ ${d.n}√ó –∑–∞–∫–∞–∑–æ–≤</div>
      </div>
      <div class="stars">${[1,2,3,4,5].map(s=>`<span class="star ${s<=r?'filled':''}" onclick="rate(${d.id},${s})">‚òÖ</span>`).join('')}</div>
    </div>`;
  }).join('');
  updateProgress();
}

function rate(dishId, score){
  if(!currentPerson) return;
  if(!ratings[currentPerson]) ratings[currentPerson]={};
  if(ratings[currentPerson][dishId]===score) ratings[currentPerson][dishId]=0;
  else ratings[currentPerson][dishId]=score;
  localStorage.setItem('vr',JSON.stringify(ratings));
  render();
}

function updateProgress(){
  const rated = currentPerson ? Object.values(ratings[currentPerson]||{}).filter(v=>v>0).length : 0;
  const total = DISHES.length;
  const pct = Math.round(rated/total*100);
  document.getElementById('progress').innerHTML = `
    <div class="num">${rated}/${total}</div>
    <div class="lbl">${currentPerson ? currentPerson+': –æ—Ü–µ–Ω–µ–Ω–æ –±–ª—é–¥' : '–í—ã–±–µ—Ä–∏ –∫—Ç–æ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç'}</div>
    <div class="bar"><div class="bar-fill" style="width:${pct}%"></div></div>`;
  
  const anyRated = PEOPLE.some(p => Object.values(ratings[p]||{}).filter(v=>v>0).length > 0);
  document.getElementById('sendBtn').disabled = !anyRated;
}

function sendResults(){
  // Build summary text
  let lines = ['üçΩ –û—Ü–µ–Ω–∫–∏ –±–ª—é–¥ –í–∞–ª–µ–Ω—Ç–∏–Ω—ã\n'];
  PEOPLE.forEach(p => {
    const r = ratings[p]||{};
    const rated = Object.entries(r).filter(([k,v])=>v>0).map(([k,v])=>{
      const d = DISHES.find(x=>x.id===+k);
      return {name:d?d.name:'?', score:v};
    }).sort((a,b)=>b.score-a.score);
    if(rated.length===0) return;
    lines.push(`${p}:`);
    rated.forEach(x => lines.push(`${'‚òÖ'.repeat(x.score)}${'‚òÜ'.repeat(5-x.score)} ${x.name}`));
    lines.push('');
  });
  
  const text = lines.join('\n');
  
  // Copy to clipboard
  navigator.clipboard.writeText(text).then(()=>{
    // Open Telegram chat with Max
    const encoded = encodeURIComponent(text);
    // Try Telegram deep link
    window.open('https://t.me/share/url?url=&text='+encoded, '_blank');
    showToast('üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ! –û—Ç–ø—Ä–∞–≤—å –≤ –¢–µ–ª–µ–≥—Ä–∞–º –ú–∞–∫—Å—É');
  }).catch(()=>{
    // Fallback: show text to copy manually
    prompt('–°–∫–æ–ø–∏—Ä—É–π –∏ –æ—Ç–ø—Ä–∞–≤—å –ú–∞–∫—Å—É:', text);
  });
}

function showToast(msg){
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'), 3000);
}

init();
render();
</script>
</body>
</html>
